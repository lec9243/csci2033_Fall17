function p = gps3d(a, b, c, d, ra, rb, rc, rd)
temp = [ 2*(a(1)-b(1)),2*(a(2)-b(2)),2*(a(3)-b(3)),(-b(1)*b(1)-b(2)*b(2)-b(3)*b(3)+a(1)*a(1)+a(2)*a(2)+a(3)*a(3)+rb*rb-ra*ra);
         2*(b(1)-c(1)),2*(b(2)-c(2)),2*(b(3)-c(3)),(-c(1)*c(1)-c(2)*c(2)-c(3)*c(3)+b(1)*b(1)+b(2)*b(2)+b(3)*b(3)+rc*rc-rb*rb);
         2*(c(1)-d(1)),2*(c(2)-d(2)),2*(c(3)-d(3)),(-d(1)*d(1)-d(2)*d(2)-d(3)*d(3)+c(1)*c(1)+c(2)*c(2)+c(3)*c(3)+rd*rd-rc*rc);];
A = rref(temp);
p = A(:,4);
end;